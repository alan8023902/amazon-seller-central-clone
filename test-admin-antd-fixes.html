<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†åå° Ant Design ä¿®å¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            border-left: 4px solid #1890ff;
            padding-left: 15px;
        }
        .test-item {
            margin: 10px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
        }
        .status.pending { background: #ffc107; color: #000; }
        .status.testing { background: #17a2b8; color: white; }
        .status.success { background: #28a745; color: white; }
        .status.error { background: #dc3545; color: white; }
        .test-button {
            background: #1890ff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }
        .test-button:hover {
            background: #40a9ff;
        }
        .results {
            margin-top: 20px;
            padding: 15px;
            background: #e9ecef;
            border-radius: 4px;
        }
        .log {
            background: #000;
            color: #00ff00;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .iframe-container {
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
            overflow: hidden;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: none;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ”§ ç®¡ç†åå° Ant Design ä¿®å¤æµ‹è¯•</h1>
        <p>æµ‹è¯•ä¿®å¤åçš„ç®¡ç†åå°æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œç‰¹åˆ«æ˜¯ TabPane å’Œ message ç»„ä»¶çš„é—®é¢˜ã€‚</p>
        
        <div class="test-section">
            <h2>ğŸš€ æœåŠ¡çŠ¶æ€æ£€æŸ¥</h2>
            <div class="test-item">
                <span>ç®¡ç†åå°æœåŠ¡ (Port 3002)</span>
                <div>
                    <span class="status pending" id="admin-status">PENDING</span>
                    <button class="test-button" onclick="testAdminService()">æµ‹è¯•</button>
                </div>
            </div>
            <div class="test-item">
                <span>åç«¯ API æœåŠ¡ (Port 3001)</span>
                <div>
                    <span class="status pending" id="api-status">PENDING</span>
                    <button class="test-button" onclick="testApiService()">æµ‹è¯•</button>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ¯ åŠŸèƒ½æµ‹è¯•</h2>
            <div class="test-item">
                <span>ç™»å½•é¡µé¢åŠ è½½</span>
                <div>
                    <span class="status pending" id="login-status">PENDING</span>
                    <button class="test-button" onclick="testLoginPage()">æµ‹è¯•</button>
                </div>
            </div>
            <div class="test-item">
                <span>Dashboard é…ç½®é¡µé¢</span>
                <div>
                    <span class="status pending" id="dashboard-config-status">PENDING</span>
                    <button class="test-button" onclick="testDashboardConfig()">æµ‹è¯•</button>
                </div>
            </div>
            <div class="test-item">
                <span>åº—é“º API è¿æ¥</span>
                <div>
                    <span class="status pending" id="store-api-status">PENDING</span>
                    <button class="test-button" onclick="testStoreApi()">æµ‹è¯•</button>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ” é”™è¯¯æ£€æŸ¥</h2>
            <div class="test-item">
                <span>æ§åˆ¶å°é”™è¯¯æ£€æŸ¥</span>
                <div>
                    <span class="status pending" id="console-errors-status">PENDING</span>
                    <button class="test-button" onclick="checkConsoleErrors()">æ£€æŸ¥</button>
                </div>
            </div>
            <div class="test-item">
                <span>TabPane é”™è¯¯æ£€æŸ¥</span>
                <div>
                    <span class="status pending" id="tabpane-status">PENDING</span>
                    <button class="test-button" onclick="checkTabPaneErrors()">æ£€æŸ¥</button>
                </div>
            </div>
        </div>

        <div class="test-section">
            <button class="test-button" onclick="runAllTests()" style="background: #28a745; padding: 12px 24px; font-size: 16px;">
                ğŸš€ è¿è¡Œæ‰€æœ‰æµ‹è¯•
            </button>
            <button class="test-button" onclick="openAdminPanel()" style="background: #6f42c1; padding: 12px 24px; font-size: 16px; margin-left: 10px;">
                ğŸ”— æ‰“å¼€ç®¡ç†åå°
            </button>
        </div>

        <div class="results" id="results" style="display: none;">
            <h3>æµ‹è¯•ç»“æœ</h3>
            <div id="summary"></div>
            <div class="log" id="log"></div>
        </div>

        <div class="iframe-container" id="iframe-container" style="display: none;">
            <h3>ç®¡ç†åå°é¢„è§ˆ</h3>
            <iframe id="admin-iframe" src=""></iframe>
        </div>
    </div>

    <script>
        let testLog = [];
        let consoleErrors = [];
        
        // æ•è·æ§åˆ¶å°é”™è¯¯
        const originalConsoleError = console.error;
        console.error = function(...args) {
            consoleErrors.push(args.join(' '));
            originalConsoleError.apply(console, args);
        };
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}`;
            testLog.push(logMessage);
            
            const logElement = document.getElementById('log');
            if (logElement) {
                logElement.innerHTML = testLog.join('\n');
                logElement.scrollTop = logElement.scrollHeight;
            }
            
            console.log(logMessage);
        }

        function updateStatus(testId, status, message = '') {
            const element = document.getElementById(testId);
            if (element) {
                element.className = `status ${status}`;
                element.textContent = status.toUpperCase();
                if (message) {
                    log(`${testId}: ${message}`);
                }
            }
        }

        async function testAdminService() {
            updateStatus('admin-status', 'testing');
            log('æµ‹è¯•ç®¡ç†åå°æœåŠ¡...');
            
            try {
                const response = await fetch('http://localhost:3002/');
                if (response.ok) {
                    updateStatus('admin-status', 'success', 'ç®¡ç†åå°æœåŠ¡æ­£å¸¸è¿è¡Œ');
                } else {
                    updateStatus('admin-status', 'error', 'ç®¡ç†åå°æœåŠ¡è¿”å›é”™è¯¯');
                }
            } catch (error) {
                updateStatus('admin-status', 'error', `ç®¡ç†åå°æœåŠ¡æ— æ³•è®¿é—®: ${error.message}`);
            }
        }

        async function testApiService() {
            updateStatus('api-status', 'testing');
            log('æµ‹è¯•åç«¯ API æœåŠ¡...');
            
            try {
                const response = await fetch('http://localhost:3001/api/health');
                if (response.ok) {
                    const data = await response.json();
                    updateStatus('api-status', 'success', `API æœåŠ¡æ­£å¸¸è¿è¡Œ (ç‰ˆæœ¬: ${data.version})`);
                } else {
                    updateStatus('api-status', 'error', 'API æœåŠ¡è¿”å›é”™è¯¯');
                }
            } catch (error) {
                updateStatus('api-status', 'error', `API æœåŠ¡æ— æ³•è®¿é—®: ${error.message}`);
            }
        }

        async function testLoginPage() {
            updateStatus('login-status', 'testing');
            log('æµ‹è¯•ç™»å½•é¡µé¢åŠ è½½...');
            
            try {
                const response = await fetch('http://localhost:3002/');
                if (response.ok) {
                    const html = await response.text();
                    if (html.includes('<!DOCTYPE html>')) {
                        updateStatus('login-status', 'success', 'ç™»å½•é¡µé¢åŠ è½½æˆåŠŸ');
                    } else {
                        updateStatus('login-status', 'error', 'ç™»å½•é¡µé¢å†…å®¹å¼‚å¸¸');
                    }
                } else {
                    updateStatus('login-status', 'error', 'ç™»å½•é¡µé¢åŠ è½½å¤±è´¥');
                }
            } catch (error) {
                updateStatus('login-status', 'error', `ç™»å½•é¡µé¢æµ‹è¯•å¤±è´¥: ${error.message}`);
            }
        }

        async function testDashboardConfig() {
            updateStatus('dashboard-config-status', 'testing');
            log('æµ‹è¯• Dashboard é…ç½®é¡µé¢...');
            
            // è¿™ä¸ªæµ‹è¯•éœ€è¦åœ¨å®é™…çš„ç®¡ç†åå°ä¸­è¿›è¡Œ
            // æˆ‘ä»¬å¯ä»¥æ£€æŸ¥ç›¸å…³çš„ API ç«¯ç‚¹æ˜¯å¦å¯ç”¨
            try {
                const response = await fetch('http://localhost:3001/api/stores');
                if (response.ok) {
                    updateStatus('dashboard-config-status', 'success', 'Dashboard é…ç½®ç›¸å…³ API å¯ç”¨');
                } else {
                    updateStatus('dashboard-config-status', 'error', 'Dashboard é…ç½® API ä¸å¯ç”¨');
                }
            } catch (error) {
                updateStatus('dashboard-config-status', 'error', `Dashboard é…ç½®æµ‹è¯•å¤±è´¥: ${error.message}`);
            }
        }

        async function testStoreApi() {
            updateStatus('store-api-status', 'testing');
            log('æµ‹è¯•åº—é“º API è¿æ¥...');
            
            try {
                const response = await fetch('http://localhost:3001/api/stores');
                if (response.ok) {
                    const data = await response.json();
                    if (data.success && data.data) {
                        updateStatus('store-api-status', 'success', `åº—é“º API æ­£å¸¸ï¼Œæ‰¾åˆ° ${data.data.length} ä¸ªåº—é“º`);
                    } else {
                        updateStatus('store-api-status', 'error', 'åº—é“º API è¿”å›æ ¼å¼é”™è¯¯');
                    }
                } else {
                    updateStatus('store-api-status', 'error', 'åº—é“º API è¿”å›é”™è¯¯');
                }
            } catch (error) {
                updateStatus('store-api-status', 'error', `åº—é“º API æµ‹è¯•å¤±è´¥: ${error.message}`);
            }
        }

        function checkConsoleErrors() {
            updateStatus('console-errors-status', 'testing');
            log('æ£€æŸ¥æ§åˆ¶å°é”™è¯¯...');
            
            if (consoleErrors.length === 0) {
                updateStatus('console-errors-status', 'success', 'æ²¡æœ‰å‘ç°æ§åˆ¶å°é”™è¯¯');
            } else {
                updateStatus('console-errors-status', 'error', `å‘ç° ${consoleErrors.length} ä¸ªæ§åˆ¶å°é”™è¯¯`);
                consoleErrors.forEach(error => log(`æ§åˆ¶å°é”™è¯¯: ${error}`));
            }
        }

        function checkTabPaneErrors() {
            updateStatus('tabpane-status', 'testing');
            log('æ£€æŸ¥ TabPane ç›¸å…³é”™è¯¯...');
            
            const tabPaneErrors = consoleErrors.filter(error => 
                error.includes('TabPane') || error.includes('is not defined')
            );
            
            if (tabPaneErrors.length === 0) {
                updateStatus('tabpane-status', 'success', 'æ²¡æœ‰å‘ç° TabPane ç›¸å…³é”™è¯¯');
            } else {
                updateStatus('tabpane-status', 'error', `å‘ç° ${tabPaneErrors.length} ä¸ª TabPane é”™è¯¯`);
                tabPaneErrors.forEach(error => log(`TabPane é”™è¯¯: ${error}`));
            }
        }

        function openAdminPanel() {
            log('æ‰“å¼€ç®¡ç†åå°é¢„è§ˆ...');
            const iframe = document.getElementById('admin-iframe');
            const container = document.getElementById('iframe-container');
            
            iframe.src = 'http://localhost:3002/';
            container.style.display = 'block';
            
            // æ»šåŠ¨åˆ° iframe
            container.scrollIntoView({ behavior: 'smooth' });
        }

        async function runAllTests() {
            document.getElementById('results').style.display = 'block';
            testLog = [];
            consoleErrors = [];
            
            log('å¼€å§‹è¿è¡Œæ‰€æœ‰æµ‹è¯•...');
            
            const tests = [
                testAdminService,
                testApiService,
                testLoginPage,
                testDashboardConfig,
                testStoreApi,
                checkConsoleErrors,
                checkTabPaneErrors
            ];
            
            for (const test of tests) {
                await test();
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            log('æ‰€æœ‰æµ‹è¯•å®Œæˆï¼');
            
            // ç”Ÿæˆæ‘˜è¦
            const statusElements = document.querySelectorAll('.status');
            let passed = 0, failed = 0, pending = 0;
            
            statusElements.forEach(element => {
                if (element.classList.contains('success')) passed++;
                else if (element.classList.contains('error')) failed++;
                else pending++;
            });
            
            document.getElementById('summary').innerHTML = `
                <strong>æµ‹è¯•æ‘˜è¦:</strong><br>
                âœ… é€šè¿‡: ${passed}<br>
                âŒ å¤±è´¥: ${failed}<br>
                â³ å¾…æµ‹è¯•: ${pending}<br>
                <strong>æ€»è®¡: ${statusElements.length}</strong>
            `;
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å¼€å§‹åŸºç¡€æ£€æŸ¥
        window.addEventListener('load', () => {
            log('Ant Design ä¿®å¤æµ‹è¯•é¡µé¢å·²åŠ è½½');
            log('ç‚¹å‡» "è¿è¡Œæ‰€æœ‰æµ‹è¯•" å¼€å§‹æµ‹è¯•');
        });
    </script>
</body>
</html>